<!DOCTYPE html>
<html lang="en" >
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="為了可能的聲音"> 
    <meta name="author" content="Rex Tsou">
    <meta name="copyright" content="Rex Tsou">
    
    <meta property="og:title" content="iOS Input Field White Screen Issue">
    <meta property="og:type" content="article">
    <meta property="og:description" content="為了可能的聲音">
    
    <meta itemprop="name" content="iOS Input Field White Screen Issue | 為了可能的聲音">
    <meta itemprop="description" content="為了可能的聲音">
    <title>iOS Input Field White Screen Issue | 為了可能的聲音</title>
    <link rel="stylesheet" href="https://blog.rex-tsou.com/css/style.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"> 
  </head>

<header class="section header">
  <div class="container">
    <nav class="nav">
      <div class="nav__left">
        <a class="nav__item" href="https://blog.rex-tsou.com"><h1 class="title">為了可能的聲音</h1></a>
      </div>
      <div class="nav__right">
        <nav class="nav__item">
          <a class="item__link" href="/post">Archives</a>
        </nav>
        <nav class="nav__item">
          
          <a class="item__link" href="https://github.com/akccakcctw" target="_blank" rel="noopener">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="item__link" href="https://www.facebook.com/akccakcctw" target="_blank" rel="noopener">
            <span class="icon">
              <i class="fa fa-facebook-square"></i>
            </span>
          </a>
          
          <a class="item__link" href="/index.xml" target="_blank" rel="noopener">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</header>

<section class="section">
  <div class="container">
    <time class="date date--publish">November 29, 2019</time>
    
    <h1 class="title">iOS Input Field White Screen Issue</h1>
    <div class="content">
      

<h2 id="tl-dr">TL;DR</h2>

<p>檢查看看 CSS 內是否有 <code>-webkit-overflow-scrolling: touch;</code>，改成 <code>-webkit-overflow-scrolling: auto;</code> 或許就能解決了。</p>

<hr />

<p>今天在公司的專案遇到一個通靈級別的 bug，只有在比較舊的 iOS 手機（iOS 10, iPhone6s）會發生。問題比較罕見，排除問題的過程也值得記錄一下。</p>

<p>專案用的是 vue，但後來測試結果證實和 vue 無關。發生問題的 code 長下面這樣：</p>

<pre><code class="language-html">&lt;input
  :id=&quot;`booking-traveler-passport-first-name-${ i }`&quot;
  v-validate=&quot;'required|passportName'&quot;
  :value=&quot;_.get(orderCustomList[i - 1], 'englishName.firstName')&quot;
  :name=&quot;`passport-firstname-${ i }`&quot;
  :placeholder=&quot;lang('booking_index_cust_data_passport_english_firstname_placeholder')&quot;
  type=&quot;text&quot;
  class=&quot;form-control&quot;
  @focus=&quot;updateIsShowBookingFixBar(false)&quot;
  @blur=&quot;updateIsShowBookingFixBar(true)&quot;
  @input=&quot;updateOrderCustomListByPath({
    $event,
    index: i - 1,
    path: 'englishName.firstName',
  })&quot;
&gt;
</code></pre>

<p>這是一個 text 類型的 <code>input</code> 輸入框，由於是用 vue 寫，因此綁定了許多特定事件在元素上，有：</p>

<ol>
<li>focus 事件：<code>updateIsShowBookingFixBar</code></li>
<li>blur 事件：<code>updateIsShowBookingFixBar</code>、觸發 v-validate 執行資料驗證</li>
<li>input 事件：<code>updateOrderCustomListByPath</code></li>
<li>:value：資料綁定</li>
</ol>

<p>語法看起來是沒問題的，只是當 <code>input</code> 被點擊（focus 事件）並觸發螢幕虛擬鍵盤展開（這時候還是正常的），再隨便按任何 2 個字元（數字、空白鍵等等都可&hellip;），當你按下第 2 個字元時，瀏覽器整個區塊會白屏。看起來很像有一層白色的 layer 覆蓋在這個區塊上，只剩下 header 和 footer。但是當你 focus 到其他元素時就回到正常。</p>

<p>當恢復正常時，繼續打字不會再度觸發白屏的 bug。但是把這個欄位清空重新輸入到第 <strong>2</strong> 個字元時又會再度觸發。</p>

<p>一開始的想法很簡單，在旁邊寫一個乾淨的 <code>input</code> 看有沒有同樣問題：</p>

<pre><code class="language-html">&lt;!-- 像這樣超乾淨 --&gt;
&lt;input type=&quot;text&quot;&gt;
</code></pre>

<p>結果沒問題，躺著按、坐著按，輸入中文 blahblah 就是沒問題。</p>

<p>看來和元素內容有關？</p>

<p>於是我開始縮小範圍做實驗，最後把可能造成問題的 property 限縮在 <code>placeholder</code> 及 <code>@focus</code> 這 2 個。</p>

<ul>
<li>2 個都沒有時完全正常</li>
<li>只有 <code>placeholder</code> 時（不管前面是否有 <code>:</code>），情形和一開始敘述的一樣</li>
<li>只有 <code>@focus</code> 時，重整頁面後輸入第 1 個字元就會觸發白屏，但是只會發生 1 次，之後就不會再觸發</li>
</ul>

<p>這時我決定去找同事尋求一些建議，同事想到其他頁面也有 <code>input</code> 欄位，而且似乎很正常沒出過問題，這時的靈光開始導向 CSS，感覺是 CSS 在作怪。</p>

<p>把 CSS 全部拿掉後，發現是正常的。然後同事就找到<a href="https://stackoverflow.com/questions/45643879/cordova-ios-white-screen-after-click-in-a-input-field#">這篇</a>，雖然這個問題非常冷門，但我搜尋一下解答中提到的</p>

<pre><code class="language-css">-webkit-overflow-scrolling: touch;
</code></pre>

<p>發現還真的有！試著改成</p>

<pre><code class="language-css">-webkit-overflow-scrolling: auto;
</code></pre>

<p>白屏的問題就解決了！</p>

<blockquote>
<p>Tips：<code>-webkit-overflow-scrolling</code> 是 iOS 的非標準 CSS 規則，用來改變手指在觸控螢幕上捲動畫面的回彈效果，設定為 auto 時，手指移開捲動會立即停止；設定為 touch 時，會有回彈效果。</p>
</blockquote>

<p>白屏的問題看起來在新版 iOS 已經修正了，不過還不太清楚問題的原因為何，又為何與 placeholder 和 focus 有關？就等之後比較有空再來研究了。</p>

<h2 id="參考資料">參考資料</h2>

<ul>
<li><a href="https://stackoverflow.com/questions/45643879/cordova-ios-white-screen-after-click-in-a-input-field">https://stackoverflow.com/questions/45643879/cordova-ios-white-screen-after-click-in-a-input-field</a>
-</li>
</ul>

    </div>
    <blockquote class="page-info">
      最後更新時間：<time class="date date--update">November 29, 2019</time>
    </blockquote>
  </div>
</section>

<section class="section disqus">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
    <script type="text/javascript">
      var disqus_shortname = 'akccakcctw';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>



<footer class="section footer">
  <div class="container">
    <p>© 2018 <a href="https://github.com/akccakcctw" target="_blank">Rex Tsou</a></p>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/vim.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scss.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-57924156-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



